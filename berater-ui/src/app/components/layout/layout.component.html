<div class="app-layout">
    <!-- Mobile Header with Burger Menu -->
    <header class="mobile-header">
        <button class="burger-menu" (click)="toggleSidebar()">
            <i class="fas fa-bars fa-2x"></i>
        </button>
        <span class="mobile-logo">{{ 'APP.NAME' | translate }}</span>
    </header>

    <!-- Sidebar Overlay for Mobile -->
    @if(sidebarOpen){
        <div class="sidebar-overlay" (click)="toggleSidebar()"></div>
    }

    <!-- Navigation -->
    <nav class="sidebar" [class.open]="sidebarOpen" [style.background]="sidebarColor">
        <div class="logo">
            <span class="logo-icon">üè¢</span>
            <h2 class="logo-text">{{ 'APP.NAME' | translate }}</h2>
        </div>

        <ul class="nav-menu">
            <!-- Hauptmen√º-Eintr√§ge -->
            <li>
                <a routerLink="/dashboard" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-dashboard fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.DASHBOARD' | translate }}</span>
                </a>
            </li>
            @if(currentUser?.role !== 'superadmin'){
            <li>
                <a routerLink="/contracts" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-file-contract fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.CONTRACTS' | translate }}</span>
                </a>
            </li>
            <li>
                <a routerLink="/customers" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-users fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.CUSTOMERS' | translate }}</span>
                </a>
            </li>
            <li>
                <a routerLink="/meters" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-bolt fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.METERS' | translate }}</span>
                </a>
            </li>
            }
            <li>
                <a routerLink="/todos" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-tasks fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.TODOS' | translate }}</span>
                </a>
            </li>
            @if(currentUser?.role !== 'superadmin'){
            <li>
                <a routerLink="/suppliers" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-truck fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.SUPPLIERS' | translate }}</span>
                </a>
            </li>
            <li>
                <a routerLink="/education" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-graduation-cap fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.EDUCATION' | translate }}</span>
                </a>
            </li>
            }
            <li>
                <a routerLink="/support" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-life-ring fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.SUPPORT' | translate }}</span>
                </a>
            </li>
            @if(currentUser?.role === 'superadmin'){
            <li>
                <a routerLink="/admin" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-users fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.USERS' | translate }}</span>
                </a>
            </li>
            <li>
                <a routerLink="/packages" routerLinkActive="active" (click)="closeMenusAndSidebar()">
                    <i class="fas fa-box fa-lg"></i>
                    <span class="nav-text">{{ 'NAV.PACKAGES' | translate }}</span>
                </a>
            </li>
            }
        </ul>

        <!-- User Section mit Dropdown -->
        <div class="user-section">
            <div class="user-menu-container">
                <div class="user-info" *ngIf="currentUser" (click)="toggleUserMenu()">
                    <div class="user-avatar">{{ getUserInitials() }}</div>
                    <div class="user-details">
                        <div class="user-name">{{ currentUser.firstName }} {{ currentUser.lastName }}</div>
                        <div class="user-role">{{ currentUser.email }}</div>
                    </div>
                    <i class="fas fa-chevron-down dropdown-icon" [class.rotated]="userMenuOpen"></i>
                </div>
                @if(userMenuOpen){
                <ul class="user-dropdown">
                    @if(currentUser?.role !== 'superadmin'){
                    <li>
                        <a routerLink="/settings" (click)="closeMenusAndSidebar()">
                            <i class="fas fa-cog"></i>
                            <span>{{ 'NAV.SETTINGS' | translate }}</span>
                        </a>
                    </li>
                    }
                    <li>
                        <a (click)="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>{{ 'NAV.LOGOUT' | translate }}</span>
                        </a>
                    </li>
                </ul>
                }
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <router-outlet></router-outlet>
    </main>
</div>
