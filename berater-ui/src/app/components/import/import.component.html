<div class="import-container">
  <h1>ðŸ“Š Daten-Import</h1>
  <p class="description">Importieren Sie Kunden und ZÃ¤hler aus Excel-Dateien</p>

  <!-- Kunden Import -->
  <div class="import-section">
    <div class="section-header">
      <h2>ðŸ‘¥ Kunden importieren</h2>
      <p class="section-description">
        Excel-Datei mit folgenden Spalten: <strong>Anrede, Accountname, Mobiltelefon, E-Mail</strong>
      </p>
    </div>

    <div class="upload-area">
      <input
        type="file"
        id="customerFileInput"
        accept=".xlsx,.xls"
        (change)="onCustomerFileSelected($event)"
        style="display: none"
      />

      <label for="customerFileInput" class="upload-label">
        <i class="fas fa-cloud-upload-alt"></i>
        <span *ngIf="!selectedCustomerFile">Datei auswÃ¤hlen (.xlsx, .xls)</span>
        <span *ngIf="selectedCustomerFile">{{ selectedCustomerFile.name }}</span>
      </label>

      <button
        class="btn-import"
        [disabled]="!selectedCustomerFile || isImportingCustomers"
        (click)="importCustomers()"
      >
        <i class="fas" [class.fa-spinner]="isImportingCustomers" [class.fa-spin]="isImportingCustomers" [class.fa-upload]="!isImportingCustomers"></i>
        {{ isImportingCustomers ? 'Importiere...' : 'Kunden importieren' }}
      </button>
    </div>

    <!-- Import Result -->
    <div *ngIf="customerImportResult" class="import-result">
      <div class="result-summary">
        <div class="result-success">
          <i class="fas fa-check-circle"></i>
          <span>{{ customerImportResult.success }} erfolgreich importiert</span>
        </div>
        <div class="result-failed" *ngIf="customerImportResult.failed > 0">
          <i class="fas fa-exclamation-circle"></i>
          <span>{{ customerImportResult.failed }} fehlgeschlagen</span>
        </div>
      </div>

      <!-- Errors -->
      <div *ngIf="customerImportResult.errors.length > 0" class="errors-section">
        <h3>Fehler-Details:</h3>
        <div class="error-list">
          <div *ngFor="let error of customerImportResult.errors" class="error-item">
            <strong>Zeile {{ error.row }}:</strong> {{ error.error }}
            <div class="error-data">{{ error.data | json }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ZÃ¤hler Import -->
  <div class="import-section">
    <div class="section-header">
      <h2>âš¡ ZÃ¤hler importieren</h2>
      <p class="section-description">
        Excel-Datei mit folgenden Spalten: <strong>ZÃ¤hlernummer, ZÃ¤hlerart, Anschrift (StraÃŸe), Anschrift (Postleitzahl), Anschrift (Stadt)</strong>
      </p>
    </div>

    <div class="upload-area">
      <input
        type="file"
        id="meterFileInput"
        accept=".xlsx,.xls"
        (change)="onMeterFileSelected($event)"
        style="display: none"
      />

      <label for="meterFileInput" class="upload-label">
        <i class="fas fa-cloud-upload-alt"></i>
        <span *ngIf="!selectedMeterFile">Datei auswÃ¤hlen (.xlsx, .xls)</span>
        <span *ngIf="selectedMeterFile">{{ selectedMeterFile.name }}</span>
      </label>

      <button
        class="btn-import"
        [disabled]="!selectedMeterFile || isImportingMeters"
        (click)="importMeters()"
      >
        <i class="fas" [class.fa-spinner]="isImportingMeters" [class.fa-spin]="isImportingMeters" [class.fa-upload]="!isImportingMeters"></i>
        {{ isImportingMeters ? 'Importiere...' : 'ZÃ¤hler importieren' }}
      </button>
    </div>

    <!-- Import Result -->
    <div *ngIf="meterImportResult" class="import-result">
      <div class="result-summary">
        <div class="result-success">
          <i class="fas fa-check-circle"></i>
          <span>{{ meterImportResult.success }} erfolgreich importiert</span>
        </div>
        <div class="result-failed" *ngIf="meterImportResult.failed > 0">
          <i class="fas fa-exclamation-circle"></i>
          <span>{{ meterImportResult.failed }} fehlgeschlagen</span>
        </div>
      </div>

      <!-- Errors -->
      <div *ngIf="meterImportResult.errors.length > 0" class="errors-section">
        <h3>Fehler-Details:</h3>
        <div class="error-list">
          <div *ngFor="let error of meterImportResult.errors.slice(0, 10)" class="error-item">
            <strong>Zeile {{ error.row }}:</strong> {{ error.error }}
            <div class="error-data">{{ error.data | json }}</div>
          </div>
          <div *ngIf="meterImportResult.errors.length > 10" class="more-errors">
            ... und {{ meterImportResult.errors.length - 10 }} weitere Fehler
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Info Box -->
  <div class="info-box">
    <h3>ðŸ’¡ Hinweise</h3>
    <ul>
      <li>Nur Excel-Dateien (.xlsx, .xls) werden unterstÃ¼tzt</li>
      <li>Die erste Zeile muss die SpaltenÃ¼berschriften enthalten</li>
      <li>Doppelte EintrÃ¤ge (basierend auf E-Mail oder Namen bei Kunden, ZÃ¤hlernummer bei ZÃ¤hlern) werden Ã¼bersprungen</li>
      <li>Maximale DateigrÃ¶ÃŸe: 10 MB</li>
      <li><strong>Kunden-Format:</strong> Accountname sollte im Format "Nachname, Vorname" sein</li>
      <li><strong>ZÃ¤hler-Arten:</strong> Strom, Gas, Wasser, WÃ¤rmepumpe, Nachtspeicher</li>
    </ul>
  </div>
</div>
