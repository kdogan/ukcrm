@if(isMobile){
  <app-customers-mobile 
    [customers]="customers" 
    (create)="showCreateModal()" 
    (edit)="editCustomer($event)" 
    (deactivate)="deactivateCustomer($event)"
    (closeActionMenu)="closeActionMenu()"
    (filterActiveChange)="filterActive = $event; loadCustomers()"
    (toggleActionMenu)="toggleActionMenu($event)"
    (searchTermChange)="searchTerm = $event; onSearchChange()"
  />
} @else {
<div class="page-container" (click)="closeActionMenu()">
  <div class="page-header">
    <h1>Kunden</h1>
    <button class="btn-primary" (click)="showCreateModal()">+ Neuer Kunde</button>
  </div>

  <div class="filters">
    <input
      type="search"
      placeholder="Suche nach Name, E-Mail..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="onSearchChange()"
      class="search-input"
    />
    <select [(ngModel)]="filterActive" (ngModelChange)="loadCustomers()" class="filter-select">
      <option [ngValue]="undefined">Alle</option>
      <option [ngValue]="true">Aktiv</option>
      <option [ngValue]="false">Inaktiv</option>
    </select>
  </div>

  <app-table-container>
    <table class="data-table">
      <thead>
        <tr>
          <th>Kundennr.</th>
          <th>Name</th>
          <th>E-Mail</th>
          <th>Telefon</th>
          <th>Status</th>
          <th>Aktionen</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let customer of customers">
          <td data-label="Kundennr.">{{ customer.customerNumber }}</td>
          <td data-label="Name">{{ customer.firstName }} {{ customer.lastName }}</td>
          <td data-label="E-Mail">{{ customer.email || '-' }}</td>
          <td data-label="Telefon">
            <span *ngIf="customer.phone" class="phone-container">
              {{ customer.phone }}
              <a [href]="'tel:' + customer.phone" class="phone-icon" title="Anrufen">üìû</a>
            </span>
            <span *ngIf="!customer.phone">-</span>
          </td>
          <td data-label="Status">
            <span class="badge" [class.badge-active]="customer.isActive" [class.badge-inactive]="!customer.isActive">
              {{ customer.isActive ? 'Aktiv' : 'Inaktiv' }}
            </span>
          </td>
          <td class="actions-cell" data-label="Aktionen">
            <div class="action-menu-container">
              <button class="action-menu-btn" (click)="toggleActionMenu(customer._id); $event.stopPropagation()">‚ãÆ</button>
              <div class="action-menu" *ngIf="activeMenuId === customer._id" (click)="$event.stopPropagation()">
                <button class="menu-item" (click)="editCustomer(customer); closeActionMenu()">‚úèÔ∏è Bearbeiten</button>
                <button class="menu-item menu-item-danger" *ngIf="customer.isActive" (click)="deactivateCustomer(customer._id); closeActionMenu()">üö´ Deaktivieren</button>
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </app-table-container>


</div>
}

  <!-- Modal -->
  <div class="modal" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h2>{{ editMode ? 'Kunde bearbeiten' : 'Neuer Kunde' }}</h2>
      <form (ngSubmit)="saveCustomer()">
        <div class="form-row">
          <div class="form-group">
            <label>Vorname*</label>
            <input type="text" [(ngModel)]="currentCustomer.firstName" name="firstName" required />
          </div>
          <div class="form-group">
            <label>Nachname*</label>
            <input type="text" [(ngModel)]="currentCustomer.lastName" name="lastName" required />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>E-Mail</label>
            <input type="email" [(ngModel)]="currentCustomer.email" name="email" />
          </div>
          <div class="form-group">
            <label>Telefon</label>
            <input type="tel" [(ngModel)]="currentCustomer.phone" name="phone" />
          </div>
            <div class="form-group" *ngIf="currentCustomer.address !== undefined">
              <label>Adresse</label>
              <input
                type="text"
                name="street"
                [(ngModel)]="currentCustomer.address.street"
                placeholder="Stra√üe"
                class="form-control"
              />
              <div class="form-row">
                <input
                  type="text"
                  name="zip"
                  [(ngModel)]="currentCustomer.address.zip"
                  placeholder="PLZ"
                  class="form-control"
                />
                <input
                  type="text"
                  name="city"
                  [(ngModel)]="currentCustomer.address.city"
                  placeholder="Stadt"
                  class="form-control"
                />
              </div>
            </div>
        </div>
        <div class="form-group">
          <label>Notizen</label>
          <textarea [(ngModel)]="currentCustomer.notes" name="notes" rows="3"></textarea>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="closeModal()">Abbrechen</button>
          <button type="submit" class="btn-primary">Speichern</button>
        </div>
      </form>
    </div>
  </div>
